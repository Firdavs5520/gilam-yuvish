<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Chek</title>

    <style>
      @media print {
        @page {
          size: 58mm auto;
          margin: 0;
        }
      }

      body {
        width: 58mm;
        margin: 0;
        padding: 6px;
        font-family: monospace;
        font-size: 11px;
      }

      .center {
        text-align: center;
      }
      .bold {
        font-weight: bold;
      }
      .line {
        border-top: 1px dashed #000;
        margin: 6px 0;
      }
      table {
        width: 100%;
        border-collapse: collapse;
      }
      td {
        padding: 2px 0;
      }
      .right {
        text-align: right;
      }
    </style>
  </head>

  <body>
    <div class="center bold">GILAM YUVISH</div>

    <div class="center">Tel: 90 000 00 00</div>

    <div class="line"></div>

    <div id="info"></div>

    <div class="line"></div>

    <table id="tbl">
      <tr class="bold">
        <td>Oâ€˜lcham</td>
        <td class="right">Summa</td>
      </tr>
    </table>

    <div class="line"></div>

    <div id="total"></div>
    <div id="paid"></div>
    <div id="rest"></div>

    <div class="line"></div>

    <div class="center">Rahmat! ðŸ˜Š</div>

    <script>
      const d = JSON.parse(localStorage.getItem("currentOrder") || "{}");

      info.innerHTML = `
      <div><b>Ism:</b> ${d.name}</div>
      <div>${new Date().toLocaleString()}</div>
    `;

      let sum = 0;
      d.items.forEach((i) => {
        sum += i.sum;
        tbl.innerHTML += `
        <tr>
          <td>${i.l}Ã—${i.w}</td>
          <td class="right">${i.sum.toLocaleString()}</td>
        </tr>
      `;
      });

      total.innerHTML = "<b>Jami:</b> " + sum.toLocaleString();
      paid.innerHTML = "Toâ€˜langan: " + (d.paid || 0).toLocaleString();
      rest.innerHTML = "Qoldiq: " + (sum - (d.paid || 0)).toLocaleString();

      window.print();
      window.onafterprint = () => window.close();
    </script>
  </body>
</html>
