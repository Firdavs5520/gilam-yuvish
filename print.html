<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Chek</title>
    <style>
      @media print {
        @page {
          size: 58mm auto;
          margin: 0;
        }
      }
      body {
        font-family: monospace;
        width: 58mm;
        padding: 6px;
        font-size: 11px;
      }
      .center {
        text-align: center;
      }
      .line {
        border-top: 1px dashed #000;
        margin: 6px 0;
      }
    </style>
  </head>
  <body>
    <div class="center"><b>GILAM YUVISH</b><br /></div>

    <div class="line"></div>

    <div id="out"></div>

    <div class="line"></div>

    <script>
      const o = JSON.parse(localStorage.getItem("currentOrder") || "{}");

      let html = `
Sana: ${o.date || ""}<br>
Ism: ${o.name || ""}<br>
Telefon: ${o.phone || ""}<br>
<div class="line"></div>
`;

      let sum = 0;
      (o.items || []).forEach((i) => {
        html += `${i.l}×${i.w} = ${i.sum.toLocaleString()}<br>`;
        sum += i.sum;
      });

      html += `
<div class="line"></div>
Jami: ${sum.toLocaleString()}<br>
To‘langan: ${(o.paid || 0).toLocaleString()}<br>
`;

      out.innerHTML = html;

      window.print();
      window.onafterprint = () => window.close();
    </script>
  </body>
</html>
