<!DOCTYPE html>
<html lang="uz">
  <head>
    <meta charset="UTF-8" />
    <title>Hisobot</title>
    <style>
      body {
        background: #f1f5f9;
        font-family: system-ui;
        padding: 20px;
      }
      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 16px;
      }
      .card {
        background: #fff;
        padding: 16px;
        border-radius: 16px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.08);
      }
      .done {
        border-left: 6px solid #16a34a;
        opacity: 0.85;
      }
      button {
        width: 100%;
        padding: 10px;
        margin-top: 10px;
        border: none;
        border-radius: 10px;
        background: #16a34a;
        color: #fff;
      }
    </style>
  </head>
  <body>
    <h1>ðŸ“Š Buyurtmalar</h1>
    <div id="grid" class="grid"></div>

    <script>
      const API = "https://gilam-yuvish-backend.onrender.com";

      async function load() {
        const res = await fetch(`${API}/orders`);
        const orders = await res.json();
        grid.innerHTML = "";

        orders.forEach((o) => {
          const div = document.createElement("div");
          div.className = "card" + (o.delivered ? " done" : "");
          div.innerHTML = `
      <b>${o.name || "â€”"}</b><br>
      ${o.phone || ""}<br><br>
      ${o.items
        .map((i) => `${i.l}Ã—${i.w} = ${i.sum.toLocaleString()}`)
        .join("<br>")}
      <br><b>Jami:</b> ${o.total.toLocaleString()}<br>
      ${
        o.delivered
          ? "âœ… Yetkazildi"
          : `<button onclick="deliver('${o._id}')">ðŸšš Yetkazildi</button>`
      }
    `;
          grid.appendChild(div);
        });
      }

      function deliver(id) {
        fetch(`${API}/orders/${id}/deliver`, { method: "PUT" }).then(load);
      }

      load();
    </script>
  </body>
</html>
